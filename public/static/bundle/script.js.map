{"version":3,"file":"script.js","mappings":";;;;;;;;;;AAAa;AACb;AACA;AACA,mCAAmC,oCAAoC,gBAAgB;AACvF,CAAC;AACD;AACA;AACA,CAAC;AACD;AACA,0CAA0C,4BAA4B;AACtE,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,4BAA4B,mBAAO,CAAC,6BAAQ;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,wBAAwB;AACrD,KAAK;AACL;AACA;AACA;AACA,wCAAwC,0CAA0C;AAClF;AACA;AACA,wCAAwC,0CAA0C;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;;;;ACvHa;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D,cAAc,GAAG,aAAa;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,cAAc;;;;;;;UChGd;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;UEtBA;UACA;UACA;UACA","sources":["webpack://visual-scripting-sandbox/./src/index.ts","webpack://visual-scripting-sandbox/./src/node.ts","webpack://visual-scripting-sandbox/webpack/bootstrap","webpack://visual-scripting-sandbox/webpack/before-startup","webpack://visual-scripting-sandbox/webpack/startup","webpack://visual-scripting-sandbox/webpack/after-startup"],"sourcesContent":["\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst node_1 = __importStar(require(\"./node\"));\r\nconst debugElement = document.getElementById('debug');\r\nconst canvas = document.getElementById('main-canvas');\r\nconst context = canvas.getContext('2d');\r\nlet bounds;\r\nconst resize = () => {\r\n    canvas.width = window.innerWidth;\r\n    canvas.height = window.innerHeight;\r\n    bounds = canvas.getBoundingClientRect();\r\n    requestAnimationFrame(draw);\r\n};\r\nwindow.addEventListener('load', resize);\r\nwindow.addEventListener('resize', resize);\r\nlet mouseHeld = false;\r\nlet cameraX = -window.innerWidth / 2;\r\nlet cameraY = -window.innerHeight / 2;\r\nlet oldMouseX = 0;\r\nlet oldMouseY = 0;\r\nconst nodes = [\r\n    new node_1.default('sysout')\r\n        .addInput(new node_1.Input('text', 'hello world'))\r\n        .addInput(new node_1.Input('text', 'hello world'))\r\n        .addInput(new node_1.Input('text', 'hello world'))\r\n        .addOutput(new node_1.Output('text'))\r\n];\r\nconst debug = (...args) => {\r\n    debugElement.innerText = args.join('');\r\n};\r\nconst draw = () => {\r\n    debug('x: ', cameraX, ', y: ', cameraY);\r\n    context.clearRect(0, 0, bounds.width, bounds.height);\r\n    drawBackgroundGraph();\r\n    context.fillStyle = '#FF0000';\r\n    nodes.forEach((node) => {\r\n        node.draw(context, { x: cameraX, y: cameraY });\r\n    });\r\n};\r\nfunction drawBackgroundGraph() {\r\n    context.fillStyle = 'rgba(220, 220, 220, 0.2)';\r\n    for (let startX = roundUp(cameraX); startX < bounds.width + roundUp(cameraX); startX += 100) {\r\n        context.fillRect(startX - cameraX, 0, 1, bounds.height);\r\n    }\r\n    for (let startY = roundUp(cameraY); startY < bounds.width + roundUp(cameraY); startY += 100) {\r\n        context.fillRect(0, startY - cameraY, bounds.width, 1);\r\n    }\r\n    context.fillStyle = 'rgba(200, 200, 200, 0.6)';\r\n    context.fillRect(-cameraX, 0, 3, bounds.height);\r\n    context.fillRect(0, -cameraY, bounds.width, 3);\r\n}\r\nconst roundUp = (x, threshold = 100) => {\r\n    if (x >= 0) {\r\n        return x % threshold === 0 ? x : x + threshold - (x % threshold);\r\n    }\r\n    return x % threshold === 0 ? x : x - (x % threshold);\r\n};\r\nlet target;\r\ncanvas.addEventListener('mousedown', (event) => {\r\n    const x = event.offsetX + cameraX;\r\n    const y = event.offsetY + cameraY;\r\n    target = nodes.find((node) => node.inBounds(x, y));\r\n    if (target) {\r\n        target.interact(event, x, y);\r\n    }\r\n    else {\r\n        mouseHeld = true;\r\n    }\r\n});\r\ncanvas.addEventListener('mouseup', () => {\r\n    mouseHeld = false;\r\n    target = undefined;\r\n});\r\ncanvas.addEventListener('focusout', () => (mouseHeld = false));\r\nwindow.addEventListener('mousemove', (event) => {\r\n    const x = event.offsetX + cameraX;\r\n    const y = event.offsetY + cameraY;\r\n    const targetNode = nodes.find((node) => node.inBounds(x, y));\r\n    if (targetNode) {\r\n        targetNode.mouseHover(event, x, y);\r\n    }\r\n    else {\r\n        document.body.style.cursor = 'default';\r\n    }\r\n});\r\nwindow.addEventListener('mousemove', (event) => {\r\n    const mouseX = event.clientX - bounds.left;\r\n    const mouseY = event.clientY - bounds.top;\r\n    if (mouseHeld) {\r\n        cameraX += oldMouseX - mouseX;\r\n        cameraY += oldMouseY - mouseY;\r\n        requestAnimationFrame(draw);\r\n    }\r\n    else if (target) {\r\n        target.move(event, oldMouseX - mouseX, oldMouseY - mouseY);\r\n        requestAnimationFrame(draw);\r\n    }\r\n    oldMouseX = mouseX;\r\n    oldMouseY = mouseY;\r\n});\r\nresize();\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Output = exports.Input = void 0;\r\nconst HEADER_MARGIN = 25;\r\nclass Node {\r\n    constructor(name, x = 0, y = 0) {\r\n        this._inputs = [];\r\n        this._outputs = [];\r\n        this._canBeDragged = false;\r\n        this.name = name;\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n    addInput(input) {\r\n        this._inputs.push(input);\r\n        return this;\r\n    }\r\n    addOutput(output) {\r\n        this._outputs.push(output);\r\n        return this;\r\n    }\r\n    interact(event, x, y) {\r\n        this._canBeDragged = false;\r\n        if (this._inHeaderBounds(x, y)) {\r\n            this._canBeDragged = true;\r\n        }\r\n        else if (this._inBodyBounds(x, y)) {\r\n            // Nothing so far ...\r\n        }\r\n    }\r\n    move(event, x, y) {\r\n        if (!this._canBeDragged)\r\n            return;\r\n        this.x -= x;\r\n        this.y -= y;\r\n    }\r\n    mouseHover(event, x, y) {\r\n        if (this._inHeaderBounds(x, y)) {\r\n            document.body.style.cursor = 'grab';\r\n        }\r\n        else {\r\n            document.body.style.cursor = 'default';\r\n        }\r\n    }\r\n    draw(context, camera) {\r\n        context.fillStyle = 'red';\r\n        this.width = 100;\r\n        this.height = Math.max(HEADER_MARGIN +\r\n            10 +\r\n            Math.max(this._inputs.length, this._outputs.length) * 20, 60);\r\n        context.fillRect(this.x - camera.x, this.y - camera.y, this.width, this.height);\r\n        context.font = '18px arial';\r\n        context.textAlign = 'center';\r\n        context.fillStyle = 'white';\r\n        context.fillText(this.name, this.x + 50 - camera.x, this.y + 15 - camera.y, this.width);\r\n        this._inputs.forEach((input, index) => {\r\n            context.fillStyle = 'purple';\r\n            context.fillRect(this.x + 5 - camera.x, this.y + HEADER_MARGIN + index * 22 - camera.y, 20, 20);\r\n        });\r\n        this._outputs.forEach((output, index) => {\r\n            context.fillStyle = 'cyan';\r\n            context.fillRect(this.x + this.width - 20 - 5 - camera.x, this.y + HEADER_MARGIN + index * 10 - camera.y, 20, 20);\r\n        });\r\n    }\r\n    inBounds(x, y) {\r\n        return (x > this.x &&\r\n            x < this.x + this.width &&\r\n            y > this.y &&\r\n            y < this.y + this.height);\r\n    }\r\n    _inHeaderBounds(x, y) {\r\n        return (x > this.x &&\r\n            x < this.x + this.width &&\r\n            y > this.y &&\r\n            y < this.y + HEADER_MARGIN);\r\n    }\r\n    _inBodyBounds(x, y) {\r\n        return (x > this.x &&\r\n            x < this.x + this.width &&\r\n            y > this.y + HEADER_MARGIN &&\r\n            y < this.y + this.height);\r\n    }\r\n}\r\nexports.default = Node;\r\nclass Input {\r\n    constructor(name, defaultValue = undefined) {\r\n        this.name = name;\r\n        this.defaultValue = defaultValue;\r\n    }\r\n}\r\nexports.Input = Input;\r\nclass Output {\r\n    constructor(name) {\r\n        this.name = name;\r\n    }\r\n}\r\nexports.Output = Output;\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/index.ts\");\n",""],"names":[],"sourceRoot":""}