(()=>{"use strict";var i={"./src/core/service.ts":
/*!*****************************!*\
  !*** ./src/core/service.ts ***!
  \*****************************/(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class s{static provide(e){return s.services.set(e.constructor.name,e),e}static retrieve(e){return s.services.get(e.name)}}(t.default=s).services=new Map},"./src/core/utils.ts":
/*!***************************!*\
  !*** ./src/core/utils.ts ***!
  \***************************/(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.roundUp=void 0;t.roundUp=(e,t=100)=>0<=e?e%t==0?e:e+t-e%t:e%t==0?e:e-e%t},"./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/function(h,e,t){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){e[i=void 0===i?s:i]=t[s]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&i(t,e,s);return r(t,e),t},d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0});const c=d(t(/*! ./service/camera.service */"./src/service/camera.service.ts")),n=d(t(/*! ./core/service */"./src/core/service.ts")),l=d(t(/*! ./service/debug.service */"./src/service/debug.service.ts")),f=d(t(/*! ./service/render.service */"./src/service/render.service.ts")),v=d(t(/*! ./service/node.service */"./src/service/node.service.ts")),o=s(t(/*! ./node */"./src/node.ts"));e=n.default.provide(new l.default),d=n.default.provide(new c.default(-window.innerWidth/2,-window.innerHeight/2)),s=document.getElementById("main-canvas");const u=n.default.provide(new f.default(s)),a=(u.camera=d,u.debugService=e,n.default.provide(new v.default));(a.renderService=u).nodeService=a,u.init(),u.draw(),a.addNode(new o.default("sysout").addInput(new o.Input("text","hello world")).addInput(new o.Input("text","hello world")).addInput(new o.Input("text","hello world")).addOutput(new o.Output("text"))),a.addNode(new o.default("sysin").addInput(new o.Input("text","hello world")).addInput(new o.Input("text","hello world")).addInput(new o.Input("text","hello world")).addOutput(new o.Output("text")))},"./src/node.ts":
/*!*********************!*\
  !*** ./src/node.ts ***!
  \*********************/(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Output=t.Input=void 0;const d=20;t.default=class{constructor(e,t=0,s=0){this._inputs=[],this._outputs=[],this.name=e,this.x=t,this.y=s,this._canBeDragged=!1}addInput(e){return this._inputs.push(e),this}addOutput(e){return this._outputs.push(e),this}interact(e,t,s){this._canBeDragged=!1,this._inHeaderBounds(t,s)?this._canBeDragged=!0:this._inBodyBounds(t,s)}move(e,t,s){this._canBeDragged&&(this.x+=t,this.y+=s)}mouseHover(e,t,s){this._inHeaderBounds(t,s)?document.body.style.cursor="grab":document.body.style.cursor="default"}draw(e,t){var s=this.x-t.x,t=this.y-t.y;this.drawHeader(e,s,t),this.drawName(e,s,t),this.drawBack(e,s,t),this.drawInputs(e,s,t+=30),this.drawOutputs(e,s,t)}drawOutputs(s,i,r){this._outputs.forEach((e,t)=>{s.fillStyle="cyan",s.fillRect(i+this.width-d-5,r+22*t,d,d)})}drawInputs(s,i,r){this._inputs.forEach((e,t)=>{s.fillStyle="purple",s.fillRect(i+5,r+22*t,d,d)})}drawHeader(e,t,s){e.fillStyle="darkred",this.width=100,e.fillRect(t,s,this.width,25)}drawBack(e,t,s){e.fillStyle="red",this.height=Math.max(5+22*Math.max(this._inputs.length,this._outputs.length)+5,60),e.fillRect(t,s+25,this.width,this.height)}drawName(e,t,s){e.font="16px arial",e.textAlign="center",e.fillStyle="white",e.fillText(this.name,t+50,s+17,this.width)}inBounds(e,t){return e>this.x&&e<this.x+this.width&&t>this.y&&t<this.y+this.height}_inHeaderBounds(e,t){return e>this.x&&e<this.x+this.width&&t>this.y&&t<this.y+25}_inBodyBounds(e,t){return e>this.x&&e<this.x+this.width&&t>this.y+25&&t<this.y+this.height}};t.Input=class{constructor(e,t=void 0){this.name=e,this.defaultValue=t}};t.Output=class{constructor(e){this.name=e}}},"./src/service/camera.service.ts":
/*!***************************************!*\
  !*** ./src/service/camera.service.ts ***!
  \***************************************/function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=(Object.defineProperty(t,"__esModule",{value:!0}),i(s(/*! ../core/service */"./src/core/service.ts")));class r extends i.default{constructor(e=0,t=0){super(),this.x=e,this.y=t}move(e,t){this.x+=e,this.y+=t}}t.default=r},"./src/service/debug.service.ts":
/*!**************************************!*\
  !*** ./src/service/debug.service.ts ***!
  \**************************************/function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=(Object.defineProperty(t,"__esModule",{value:!0}),i(s(/*! ../core/service */"./src/core/service.ts")));class r extends i.default{constructor(){super(...arguments),this.debug=(...e)=>{this.debugElement.innerText=e.join("")}}get debugElement(){return this._debugElement||(this._debugElement=document.getElementById("debug")),this._debugElement}}t.default=r},"./src/service/node.service.ts":
/*!*************************************!*\
  !*** ./src/service/node.service.ts ***!
  \*************************************/function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=(Object.defineProperty(t,"__esModule",{value:!0}),i(s(/*! ../core/service */"./src/core/service.ts")));class r extends i.default{constructor(){super(...arguments),this._nodes=[]}addNode(e){return this._nodes.push(e),this.renderService.draw(),e}selectNode(t){var e=this.nodes.findIndex(e=>t===e),e=this.nodes.splice(e,1);this.nodes.push(...e),this.renderService.draw()}get nodes(){return this._nodes}getNodeAt(t,s){for(let e=this.nodes.length-1;0<=e;e--){const i=this.nodes[e];if(i.inBounds(t,s))return i}}}t.default=r},"./src/service/render.service.ts":
/*!***************************************!*\
  !*** ./src/service/render.service.ts ***!
  \***************************************/function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=(Object.defineProperty(t,"__esModule",{value:!0}),i(s(/*! ../core/service */"./src/core/service.ts")));const r=s(/*! ../core/utils */"./src/core/utils.ts");class d extends i.default{constructor(e){super(),this.resize=()=>{this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.bounds=this.canvas.getBoundingClientRect(),this.camera.width=this.bounds.width,this.camera.height=this.bounds.height,requestAnimationFrame(this.draw)},this.draw=()=>{this.debugService.debug("x: ",this.camera.x,", y: ",this.camera.y),this.context.clearRect(0,0,this.bounds.width,this.bounds.height),this.drawBackgroundGraph(),this.context.fillStyle="#FF0000",this.nodeService.nodes.forEach(e=>{e.draw(this.context,this.camera)})},this.updateCursorStyleOnNodeHover=e=>{var t=e.offsetX+this.camera.x,s=e.offsetY+this.camera.y;const i=this.nodeService.getNodeAt(t,s);i?i.mouseHover(e,t,s):document.body.style.cursor="default"},this.canvas=e,this.context=e.getContext("2d"),this.mouseHeld=!1,this.oldMouseX=0,this.oldMouseY=0}init(){this.initListeners(),this.resize()}initListeners(){window.addEventListener("load",this.resize),window.addEventListener("resize",this.resize),window.addEventListener("mouseup",()=>{this.mouseHeld=!1,this.targetNode=void 0}),window.addEventListener("focusout",()=>this.mouseHeld=!1),window.addEventListener("mousemove",this.updateCursorStyleOnNodeHover),window.addEventListener("mousemove",e=>{var t=e.clientX-this.bounds.left,s=e.clientY-this.bounds.top,i=this.oldMouseX-t,r=this.oldMouseY-s;this.mouseHeld?(this.camera.move(i,r),requestAnimationFrame(this.draw)):this.targetNode&&(this.targetNode.move(e,-i,-r),requestAnimationFrame(this.draw)),this.oldMouseX=t,this.oldMouseY=s}),this.canvas.addEventListener("mousedown",e=>{var t=e.offsetX+this.camera.x,s=e.offsetY+this.camera.y;this.targetNode=this.nodeService.getNodeAt(t,s),this.targetNode?(this.nodeService.selectNode(this.targetNode),this.targetNode.interact(e,t,s)):this.mouseHeld=!0}),this.canvas.addEventListener("focusout",()=>this.mouseHeld=!1)}drawBackgroundGraph(){this.context.fillStyle="rgba(220, 220, 220, 0.2)";for(let e=(0,r.roundUp)(this.camera.x);e<this.bounds.width+(0,r.roundUp)(this.camera.x);e+=100)this.context.fillRect(e-this.camera.x,0,1,this.bounds.height);for(let e=(0,r.roundUp)(this.camera.y);e<this.bounds.width+(0,r.roundUp)(this.camera.y);e+=100)this.context.fillRect(0,e-this.camera.y,this.bounds.width,1);this.context.fillStyle="rgba(200, 200, 200, 0.6)",this.context.fillRect(-this.camera.x,0,3,this.bounds.height),this.context.fillRect(0,-this.camera.y,this.bounds.width,3)}}t.default=d}},r={};(function e(t){var s=r[t];if(void 0!==s)return s.exports;s=r[t]={exports:{}};return i[t].call(s.exports,s,s.exports,e),s.exports})("./src/index.ts")})();